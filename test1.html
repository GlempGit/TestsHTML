<div>
    Vous pouvez desormais retourner un produit via Turnee <a href="{{ 'your-custom-page-url' }}/retourTurnee.html"
        class="custom-button">en savoir plus</a>
    <div class="product-form__buttons form">
        <button type="submit" name="returnTurnee" id="returnTurnee" class="product-form__submit button button--primary">
            Retour Turnee
        </button>
        

        <!--button type="submit" name="returnClassique" id="returnClassique"
            class="product-form__submit button button--primary">
            Retour Standard
        </button-->
    </div>
    <div>
        <a href="testURL.HTML">Retour Standard</a>
    </div>
    
</div>

<script>
    const classiqueReturnButton = document.getElementById('returnClassique');
    const turneeReturnButton = document.getElementById('returnTurnee');

    // Add an event listener to the button
    classiqueReturnButton.addEventListener('click', function () {
        alert('Retour classique de la marque');
    });

    // Add an event listener to the button
    turneeReturnButton.addEventListener('click', function () {

        // Get the order created_at value from Shopify
        const shopifyOrderCreatedAt = '{{ order.created_at }}';

        // Create a Date object from the Shopify date string
        const shopifyDate = new Date(shopifyOrderCreatedAt);

        // Format the date as "YYYY/MM/DD HH:MM:SS"
        const formattedDate =
            `${shopifyDate.getFullYear()}-` +
            `${(shopifyDate.getMonth() + 1).toString().padStart(2, '0')}-` +
            `${shopifyDate.getDate().toString().padStart(2, '0')} ` +
            `${shopifyDate.getHours().toString().padStart(2, '0')}:` +
            `${shopifyDate.getMinutes().toString().padStart(2, '0')}:` +
            `${shopifyDate.getSeconds().toString().padStart(2, '0')}`;

        alert(formattedDate);

        const requestData = {
            orderNumber: '{{ order.name }}',
            orderDateCreated: formattedDate,
            productNumber: 'ABC123',
            reason: 'Doesn\'t like the product',
            contactInformation: {
                firstName: '{{ order.customer.first_name }}',
                lastName: '{{ order.customer.last_name }}',
                email: '{{ order.customer.email }}',
                //phoneNumber: '{{ order.customer.phone }}'
                phoneNumber: '0123456789'
            }
        };

        const body = JSON.stringify(requestData);

        fetch('https://myturneesapilibrary.lm.r.appspot.com/api/returnProduct', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                //'Authorization': 'Bearer YOUR_API_TOKEN' // Add any required authentication headers here
            },
            body
        })
            .then(response => response.json())
            .then(data => {
                // Handle the API response as needed
                console.log(data);

                // Display the message when the button is clicked
                document.getElementById('messageContainer').innerHTML = 'Merci pour votre retour Turnee. Numéro de commande {{ order.name }}';
            })
            .catch(error => {
                // Handle errors
                console.error(error);

                // Display the message when the button is clicked
                document.getElementById('messageContainer').innerHTML = '!!! Erreur lors de l enregistrement de votre retour Turnee. Numéro de commande {{ order.name }}';
            });

    });

</script>